# texture = filename								The icon that will show up in the Lens and on the map when this Focus is deployed
# modifier											The effects this Decree has on its state
# cost												The cost in AUT to set this Decree on a state (scales with Power Rank)
# unlocking_technologies							A list of technologies, at least one of which must be known to the country to use this Focus
# unlocking_laws									A list of laws, at least one which must be active in the country to use this Focus. If the country switches away from all unlocking laws the Focus will be removed
# country_trigger									A trigger in country context that determines if the Decree is permitted/shown in interface or not; should invalidate the Decree on a weekly basis if found invalid 
# state_trigger										A trigger in state context that determines if the Decree is permitted or not; should invalidate the Decree on a weekly basis if found invalid 
# ai_weight											Scripted value which determines the chance of getting the Decree by AI

# Cannot use INJECT because we actually change a weighting block.
TRY_REPLACE:decree_promote_national_values = {
	texture = "gfx/interface/icons/decree/decree_promote_national_values.dds"
	unlocking_technologies = {
		centralization
	}
	#state_trigger = {	# The player may have other mods which mean this is still sensible to be used, but the AI shouldn't (added to ai_weight block)
	#	OR = {
	#		has_assimilating_pops = yes
	#		has_converting_pops = yes
	#	}
	#}
	modifier = {
		state_assimilation_mult = 1
		state_conversion_mult = 1
		state_allow_assimilation_in_homeland_bool = yes
		state_radicals_and_loyalists_from_sol_change_mult = 0.15
		state_radicalism_increases_violent_hostility_mult = 0.5
		state_radicalism_increases_cultural_erasure_mult = 0.4
		state_radicalism_increases_open_prejudice_mult = 0.3
	}
	cost = 100
	
	ai_weight = {
		value = 0
		if = {
			limit = {
				scope:country = {
					NOT = {	# NOR
						# has_law_or_variant = law_type:law_multicultural	# The AI still needs to do this for performance reasons
						has_law_or_variant = law_type:law_subjecthood
					}
				}
				primary_cultures_percent_state <= 0.9
			}

			if = { # Colonies
				limit = {
					scope:country = {
						country_is_in_europe = no
						any_primary_culture = {
							has_discrimination_trait_group = heritage_group_european
						}
						NOR = {
							has_government_type = gov_chartered_company
							c:BIC ?= this
							c:DEI ?= this
						}
					}
				}
				add = 300
			}
			else_if = {
				limit = {
					scope:country = {
						OR = {
							has_strategy = ai_strategy_reactionary_agenda
							has_strategy = ai_strategy_conservative_agenda
							has_strategy = ai_strategy_maintain_mandate_of_heaven
						}
					}
				}
				add = 100
			}
			else_if = {
				limit = {
					scope:country = {
						has_strategy = ai_strategy_nationalist_agenda
					}
				}
				add = 200
			}


			if = {
				limit = {
					primary_cultures_percent_state <= 0.1
				}
				multiply = 5.0
			}
			else_if = {
				limit = {
					primary_cultures_percent_state <= 0.3
				}
				multiply = 3.0
			}
			else_if = {
				limit = {
					primary_cultures_percent_state <= 0.5
				}
				multiply = 2.0
			}

			if = {
				limit = {
					is_homeland_of_country_cultures = scope:country
				}
				multiply = 5.0
			}
		}

		if = {
			limit = {
				OR = {
					NOT = { scope:country = { has_law_or_variant = law_type:law_total_separation } }
					AND = {
						scope:country = { country_is_in_africa = no }
						state_is_in_africa = yes
					}
				}
				religion_percent_state = {
					target = scope:country.religion
					value <= 0.9
				}
			}

			if = {
				limit = {
					scope:country = {
						has_strategy = ai_strategy_conservative_agenda
					}
				}
				add = 50
			}
			else_if = {
				limit = {
					scope:country = {
						has_strategy = ai_strategy_reactionary_agenda
					}
				}
				add = 100
			}

			if = {
				limit = {
					scope:country = {
						OR = {
							has_law_or_variant = law_type:law_state_religion
							has_law_or_variant = law_type:law_state_atheism
						}
					}
				}
				add = 50
			}

			if = {
				limit = {
					religion_percent_state = {
						target = scope:country.religion
						value <= 0.1
					}
				}
				multiply = 5.0
			}
			else_if = {
				limit = {
					religion_percent_state = {
						target = scope:country.religion
						value <= 0.3
					}
				}
				multiply = 3.0
			}
			else_if = {
				limit = {
					religion_percent_state = {
						target = scope:country.religion
						value <= 0.5
					}
				}
				multiply = 2.0
			}
		}

		if = {
			limit = {
				state_population < 100000
			}
			multiply = 0
		}
		else_if = {
			limit = {
				state_population < 300000
			}
			multiply = 2.0
		}
		else_if = {
			limit = {
				scope:country = {
					OR = {
						has_law = law_type:law_cultural_exclusion
						has_law = law_type:law_freedom_of_conscience
					}
				}
			}
			multiply = 0.5
		}
		else_if = {
			limit = {
				scope:country = {
					OR = {
						has_law = law_type:law_multicultural
						has_law = law_type:law_total_separation
					}
				}
			}
			multiply = 0.1
		}

		if = { # Deliberately placed here since we want the AI to ignore laws for this
			limit = {
				scope:country = {
					has_journal_entry = je_south_american_national_identity
				}
			}
			add = 500
		}

		if = {
			limit = {
				primary_cultures_percent_state > 0.9
				religion_percent_state = {
					target = scope:country.religion
					value > 0.9
				}
			}
			multiply = 0
		}
		else_if = {
			limit = {
				primary_cultures_percent_state > 0.5
				religion_percent_state = {
					target = scope:country.religion
					value > 0.5
				}
			}
			multiply = 0.5
		}
	}
}
