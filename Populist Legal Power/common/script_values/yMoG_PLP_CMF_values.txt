### CMF in-built value overwrites:
## Cultural Movement Values
REPLACE_OR_CREATE:com_movement_cultural_minority_secession_possible_culture_percent_state = { value = 0.15 }	# 0.05
REPLACE_OR_CREATE:com_movement_cultural_minority_secession_state_weight_culture_percent_state_0 = { value = 0.10 }	# 0.05
# REPLACE_OR_CREATE:com_movement_cultural_minority_secession_state_weight_culture_percent_state_1 = 0.75	# Use Default
# REPLACE_OR_CREATE:com_movement_cultural_minority_secession_state_weight_culture_percent_state_2 = 0.5		# Use Default
# REPLACE_OR_CREATE:com_movement_cultural_minority_secession_state_weight_culture_percent_state_3 = 0.25	# Use Default
REPLACE_OR_CREATE:com_movement_cultural_minority_secession_state_weight_culture_percent_state_4 = { value = 0.15 }	# 0.1
REPLACE_OR_CREATE:com_movement_cultural_minority_secession_target_fraction_of_states_min = { value = 0.05 }	# 0.15
REPLACE_OR_CREATE:com_movement_cultural_minority_secession_target_fraction_of_states_max = { value = 0.90 }	# 0.75

## Religious Movement Values
REPLACE_OR_CREATE:com_movement_religious_minority_secession_possible_religion_percent_state = { value = 0.15 }	# 0.10
REPLACE_OR_CREATE:com_movement_religious_minority_secession_state_weight_religion_percent_state_0 = { value = 0.10 }	# 0.05
# REPLACE_OR_CREATE:com_movement_religious_minority_secession_state_weight_religion_percent_state_1 = 0.75	# Removed in 1.10.3 # Use Default
# REPLACE_OR_CREATE:com_movement_religious_minority_secession_state_weight_religion_percent_state_2 = 0.5	# Removed in 1.10.3 # Use Default
# REPLACE_OR_CREATE:com_movement_religious_minority_secession_state_weight_religion_percent_state_3 = 0.25	# Removed in 1.10.3 # Use Default
# REPLACE_OR_CREATE:com_movement_religious_minority_secession_state_weight_religion_percent_state_4 = 0.15	# Removed in 1.10.3 # 0.1
REPLACE_OR_CREATE:com_movement_religious_minority_secession_target_fraction_of_states_min = { value = 0.05 }	# 0.15
REPLACE_OR_CREATE:com_movement_religious_minority_secession_target_fraction_of_states_max = { value = 0.90 }	# 0.75

## Ideological Movement Values
REPLACE_OR_CREATE:com_movement_anti_slavery_pop_support_weight_type_slaves = { value = 500 }					# 50
REPLACE_OR_CREATE:com_movement_anti_slavery_revolution_possible_political_movement_support = { value = 0.1 }	# 0.05
REPLACE_OR_CREATE:com_movement_anti_slavery_secession_possible_political_movement_support = { value = 0.1 }		# 0.05
REPLACE_OR_CREATE:com_movement_pro_slavery_revolution_possible_political_movement_support = { value = 0.1 }		# 0.05
REPLACE_OR_CREATE:com_movement_pro_slavery_secession_possible_political_movement_support = { value = 0.1 }		# 0.05

### PLP values for CMF:
## ALL Movement Values
# Because people aren't actually idiots, and revolts during occupation are how genocides happen.
# The only exception is Pan-National movements which are a whole different kettle of fish.
REPLACE_OR_CREATE:mog_plp_movement_all_general_state_weight_mult = {
	value = 1
	if = {
		limit = {
			owner = {
				is_at_war = yes
				OR = {
					any_enemy_in_war = {	# Can't test for a specific state being targeted by *any* country so here we go.
						OR = {
							war_participant_has_war_goal_of_type_against = {
								type = conquer_state
								target = prev
							}
							war_participant_has_war_goal_of_type_against = {
								type = return_state
								target = prev
							}
							war_participant_has_war_goal_of_type_against = {
								type = annex_country
								target = prev
							}
							war_participant_has_war_goal_of_type_against = {
								type = take_treaty_port
								target = prev
							}
							war_participant_has_war_goal_of_type_against = {
								type = contain_threat
								target = prev
							}
							war_participant_has_war_goal_of_type_against = {
								type = unification
								target = prev
							}
							war_participant_has_war_goal_of_type_against = {
								type = liberate_country
								target = prev
							}
						}
					}
					NOT = { this ?= prev.controller }
				}
			}
		}
		multiply = 0
	}
}

## Cultural Movement Values
REPLACE_OR_CREATE:mog_plp_movement_cultural_minority_pop_support_weight_mult = {
	# Actual conditions relative to their neighbours
	value = 1.0
	add = {
		#value = "owner.average_sol"
		value = "owner.average_sol_for_primary_cultures"
		subtract = "owner.average_sol_for_culture(scope:culture)"
		multiply = 0.05
	}
	desc = "STANDARD_OF_LIVING_FOR_CULTURE"
}

REPLACE_OR_CREATE:mog_plp_movement_cultural_minority_additional_radicalism_factor_add = {		# Not Currently Used
	value = 0
#	if = {
#		limit = {
#			NOT = {
#				scope:culture = {
#					shares_trait_with_any_primary_culture = root.owner
#				}
#			}
#		}
#		
#		subtract = {
#			desc = "INSTITUTION_FUNDING_LEVEL_colonial_affairs"
#			value = {
#				owner.institution:institution_colonial_affairs.investment
#			}
#			multiply = 0.05
#		}
#	}
}

REPLACE_OR_CREATE:mog_plp_movement_minority_rights_pop_support_weight_mult = {
	value = 1.0
	add = {
		value = "owner.average_sol_for_primary_cultures"
		subtract = "owner.average_sol_for_culture(root.culture)"
		multiply = 0.05
	}
	desc = "STANDARD_OF_LIVING_FOR_CULTURE"
}

## Religious Movement Values
REPLACE_OR_CREATE:mog_plp_movement_religious_minority_pop_support_weight_mult = {
	# Actual conditions relative to their neighbours
	value = 1
	add = {
		value = "owner.average_sol_for_religion(owner.religion)"
		subtract = "owner.average_sol_for_religion(scope:religion)"
		multiply = 0.05
	}
	desc = "STANDARD_OF_LIVING_FOR_RELIGION"
}

## Ideological Movement Values
REPLACE_OR_CREATE:mog_plp_movement_anti_slavery_pop_support_weight_cultural_solidarity_add = {
	# PLP - Cultural solidarity between enslaved and non-enslaved pops
	if = {
		limit = {
			OR = {
				owner = { has_law_or_variant = law_type:law_slave_trade }
				owner = { has_law_or_variant = law_type:law_legacy_slavery }
				AND = {
					owner = { has_law_or_variant = law_type:law_colonial_slavery }
					state = { is_slave_state = no } # If you're in a slave state, concerns about being personally enslaved apply instead
				}
			}
		}
		add = {
			desc = "CULTURE_ENSLAVED_PERCENT"
			value = 100

			save_temporary_scope_as = pop
			owner = {
				every_in_list = {
					variable = culture_enslaved_percent_cache
					save_temporary_scope_as = kvp
					scope:pop.owner = {
						ordered_in_list = {
							variable = culture_enslaved_percent_cache_keys
							position = scope:kvp.kvp_to_key
							save_temporary_scope_as = key
						}
					}
					if = {
						limit = {
							scope:pop.culture = scope:key
						}
						multiply = scope:kvp.kvp_to_value
					}
				}
			}
		}
	}
}

REPLACE_OR_CREATE:mog_plp_movement_anti_slavery_pop_support_weight_personal_add = {
	# PLP - More opposed if you personally are at risk of being enslaved
	if = {
		limit = {
			owner = { has_law_or_variant = law_type:law_debt_slavery }
		}
		add = {
			desc = "POP_POVERTY"
			value = define:NEconomy|DEBT_SLAVERY_ENSLAVEMENT_RATE_PER_POP
			subtract = {
				value = wealth
				multiply = define:NEconomy|DEBT_SLAVERY_ENSLAVEMENT_RATE_DROP_OFF_PER_WEALTH
			}
			multiply = 100
		}
	}
	if = {
		limit = {
			owner = { has_law_or_variant = law_type:law_colonial_slavery }
			state = { is_slave_state = yes }
			pop_acceptance < define:NEconomy|COLONIAL_SLAVERY_ACCEPTANCE_THRESHOLD
		}
		add = {
			desc = "POP_POVERTY"
			value = define:NEconomy|COLONIAL_SLAVERY_ENSLAVEMENT_RATE_PER_POP
			subtract = {
				value = wealth
				multiply = define:NEconomy|COLONIAL_SLAVERY_ENSLAVEMENT_RATE_DROP_OFF_PER_WEALTH
			}
			multiply = 100
		}
	}
}

REPLACE_OR_CREATE:mog_plp_movement_pro_slavery_pop_support_weight_owner_add = {
	if = {
		limit = {
			and = {
				is_employed = yes
				workplace = { is_building_group = bg_owner_buildings }
			}
		}
		add = {
			desc = SLAVE_OWNER
			value = 15
			multiply = {
				state = {
					value = "pop_type_percent_state(pop_type:slaves)"
					multiply = 2
					divide = {
						add = "pop_type_percent_state(pop_type:laborers)"
						add = "pop_type_percent_state(pop_type:peasants)"
						min = 1
					}
				}
				max = 1
			}
		}
	}
}

REPLACE_OR_CREATE:mog_plp_movement_pro_slavery_pop_support_weight_enslaved_percent_mult = {
	add = {
		desc = "CULTURE_ENSLAVED_PERCENT"
		value = 1

		save_temporary_scope_as = pop
		owner = {
			every_in_list = {
				variable = culture_enslaved_percent_cache
				save_temporary_scope_as = kvp
				scope:pop.owner = {
					ordered_in_list = {
						variable = culture_enslaved_percent_cache_keys
						position = scope:kvp.kvp_to_key
						save_temporary_scope_as = key
					}
				}
				if = {
					limit = {
						scope:pop.culture = scope:key
					}
					subtract = {
						value = scope:kvp.kvp_to_value
						multiply = 2
					}
				}
			}
		}
		min = 0
	}
}

REPLACE_OR_CREATE:mog_plp_movement_mainland_general_pop_support_weight_incorporation_percent_mult = {
	# PLP - Colonized pops care about mainland politics to the extent it affects them
	value = 1
	if = {
		limit = {
			state = { is_incorporated = no }
			pop_has_primary_culture = no
		}
		state = {
			multiply = incorporation_progress
		}
	}
}